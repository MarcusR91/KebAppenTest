import axios, { AxiosResponse } from "axios";
import { useEffect, useState } from "react";
import { Link } from "react-router-dom"
import { urlDrinks } from "../../Endpoints";
import { Button } from "../utils/Button";
import GenericList from "../utils/GenreicList";
import { DrinkDto } from "./Models/Drinks.model";


export const IndexDrinks = () => {

    const [drinks, setDrinks] = useState<DrinkDto[]>();

    useEffect(()=>{
        loadDrinks();
    },[drinks])

    const DeleteDrink = async(id: number) => {
        try {
            axios.delete(`${urlDrinks}/${id}`);
        } catch (error) {
            console.error(error);
        }
    }

    const loadDrinks = () => {
        axios.get(urlDrinks)
        .then((response: AxiosResponse<DrinkDto[]>) =>{
            setDrinks(response.data);
            
        })
    }

    return(
        <>
            <h3>Drink</h3>
            <Link className="btn btn-primary"  to="drinks/create">Create Drink</Link>

            <GenericList list={drinks}>
                <table className="table table-striped">
                    <thead>
                        <th></th>
                        <th>Drinks</th>
                    </thead>
                    <tbody>{drinks?.map(drink => 
                        <tr key={drink.id}>
                            <td>
                                <Link className="btn btn-success" to={`/drinks/edit/${drink.id}`}>Edit</Link>
                                <Button onClick={() => DeleteDrink(drink.id)} className="btn btn-danger">Delete</Button>
                            </td>
                            <td>
                                {drink.typeOfDrink}
                            </td>
                        </tr>
                        )}

                    </tbody>
                </table>
            </GenericList>
        </>
    )
}