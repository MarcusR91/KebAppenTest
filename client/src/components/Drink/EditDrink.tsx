import axios, { AxiosResponse } from "axios";
import { useEffect, useState } from "react";
import { useHistory, useParams } from "react-router-dom";
import { urlDrinks } from "../../Endpoints";
import { Loading } from "../utils/Loading";
import { DrinksForm } from "./DrinksForm"
import { DrinkDto, DrinksCreationDto } from "./Models/Drinks.model";

export const EditDrink = () => {

    const {id}: any = useParams();
    const history = useHistory();
    const [drink, setDrink] = useState<DrinksCreationDto>();

    useEffect(()=>{
        axios.get(`${urlDrinks}/${id}`)
        .then((response: AxiosResponse<DrinkDto>) =>{
            setDrink(response.data);

        })
    },[id])

    const editDrink = async (drinkToEdit: DrinksCreationDto) => {
        try {
            await axios.put(`https://localhost:7117/api/Drink/${id}`, drinkToEdit);
            history.push("/drinks");
        } catch (error) {
                console.error(error)
            
        }
    }
    
    return(
        <>
            <h3>Edit Drink</h3>

            {drink ?  <DrinksForm model = {{typeOfDrink: 'Action'}} 
            onSubmit={async value =>{
            await editDrink(value)
           }}/> : <Loading />}
           
        </>
    )
}